# S3の概要

## AWSストレージサービス
AWSは３つの形式のストレージサービスを提供
### ブロックストレージ(Block Storage)
- EC2にアタッチして活用するディスクサービス
- ブロック形式でデータを保存
- 高度・広帯域幅（bandwidth）
- ex)EBS、インスタンスストア
### オブジェクトストレージ（Object Storage）
- 安価かつ安い耐久性をもつオンラインストレージ
- オブジェクト形式でデータを保存
- ex)S3、Glacier
### ファイルストレージ（File Storage）
- 複数のEC2インスタンスから同時にアタッチ可能な共有ストレージサービス
- ファイル形式でデータを保存
- ex)EFS

## Simple Storage Service（S3）
ユーザがデータを容量制限なく保存可能なマネージド型で提供されるオブジェクト型ストレージ
### 特徴
- 高い耐久性：99.999999999%
- 安価なストレージ：月額1GB/3円
- スケーラブルで安定した性能：データは冗長化（じょうちょうか）されて保存されデータ容量に依存しない性能がAWS側で保証される
- 暗号化：転送中や保存時にデータを暗号化可能
### データ保存形式
- バケット：オブジェクトの保存場所。名前はグローバルでユニークな必要あり
- オブジェクト：S3に格納されるファイルでURLが付与される。バケット内オブジェクト数は無制限
- データサイズ
データサイズは0KBから5TBまで保存可能

## オブジェクト構成
- Key：オブジェクトの名前
- Value：データそのものであり、バイト値で構成される
- バージョンID：バージョン管理に用いるID
- メタデータ：オブジェクトに付随（ふずい・부수、관련된、연관된）する属性の情報
- サブリソース：ex) ACLやバケットポリシ

## S3のデータ構造
S3
↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓
ベケット　ベケット
↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓
オブジェクト　オブジェクト　オブジェクト　オブジェクト

## AWSストレージサービス
S3の用途に応じてストレージタイプを選択する
- STANDARD：複数箇所にデータを複製するため、耐久性が高い
- STANDARD-IA：30日以上維持すると、$0.0125/GB、検索は$0.01/GB *IAは可用性が低いけど安い
- One Zone-IA：安全ではないデータを置くときに使用、STANDARD-IAより20%くらい安い
- RRS（Reduced Redundancy Storage）：非推薦、耐久性低い、可用性低い
- Amazon Glacier：めっちゃ安いけど、データ抽出にコストと時間がかかる、$0.00099/GB

## S3 Intelligent-Tiering
低頻度アクセスのオブジェクトを自動的に低頻度アクセス層に移動することでコストを安くする
代わりに、データ抽出に時間がかかる

## S3の生合成モデル
S3は高い可用性を実現するため、データ更新・削除には結果整合生モデルを採用。
同時書込みはタイムスタンプ処理を実施

## S3のアクセス管理
S3のアクセス管理は用途に応じて方式を使い分ける
- IAMユーザーポリシー：IAMユーザーに対してS3サービスへのアクセス権限を設定することができる。一元的にユーザー権限を管理
- バケットポリシー：バケット自体のアクセス権限を制御。アクセス権をJSONで設定
- ACL(Access control list）：：オブジェクトへのアクセス権限をXMLで設定する
- 署名付きURL：一時的なアクセスを許可させるため、AWS SDKで生成した署名付きURLで共有

## S3の暗号化
S3へのデータ保管時に暗号化として以下の4つの形式から選択する

- SSE-S3：一番標準的な方式、暗号化キーの作成・管理をS3側で自動で実施
- SSE-KMS：AWS KMSに設定した暗号化キーを利用した暗号化を実施
- SSE-C：ユーザーが指定したキーによるサーバー側での暗号化を使用することが可能
- クライアントサイド暗号化（CSE）：クライアント側の暗号化では、AmazonS3に送信する前にデータを暗号化する方式

## S3アクセスポイント
S3上の共有データセットを使用するアプリケーションへの大規模なデータアクセス管理を実施
### 作り方
- アクセスポイント作成
- アクセス制御設定
- VPCアクセス制限設定
- アクセス管理の実行

## S3アクセスアナライザー
アクセスポリシーに沿っているかを確認し、不正なアクセスが発生していないか、アクセスポリシーを監視する機能
- IAMアクセスアナライザー（IAM上の機能）に連動したS3向けの機能
- バケットポリシー/ACLのモニタリング
- パブリックまたは共有バケットアクセスを検出
- バケットポリシー、バケットACLまたはその両方。バケットアクセスのソースを検索して確認する場合は、この列の情報をまず使用して、迅速で正確なアクセス、位置で実行する
- 全てのパブリックバケットと共有バケットの結果を表示する
- バケットの実際のアクセス状況を確認する