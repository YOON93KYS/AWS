# EBSの概要

## EBS（Amazon Elastic Block Store）とは
EBSはEC2インスタンスと共に利用されるブロックストレージ
インスタンス上のワークロードなどに利用

## EBSの選択
AWSは3つの形式のストレージサービスを提供

### ブロックストレージ
- EC2にアタッチして活用するディスクサービス
- ブロック形式でデータを保存
- 必要なブロックにデータを読み取りに行ってるので、高速でデータ検索可能
- 高度・広帯域幅（bandwidth）
- ex)EBS、インスタンスストア

### オブジェクトストレージ
- 安価かつ高い耐久性を持つオンラインストレージ
- オブジェクト形式でデータを保存
- デフォルトで複数AZに冗長化（じょうちょうか）されている
- ex)S3、Glacier

冗長化：望ましい状態のこと
### ファイルストレージ
- 複数のEC2インスタンスから同時にアタッチ可能な共有ストレージサービス
- ファイル形式でデータを保存
- ex)EFS（Amazon Elastic File System）

EC2が利用するのはインスタンスストアとEBSの２タイプのストレージ

### インスタンスストア
- ホストコンピュータに内蔵（ないぞう）されたディスクでEC2と不可分のブロックレベルの物理ストレージ
- EC2の一時的なデータが保存され、EC2の停止・終了と共にデータがクリアされる
- 無料

### EBS(Elastic Block Store)
- ネットワークで接続されたブロックレベルのストレージでEC2とは独立管理
- EC2を終了してもEBSデータは保持可能
- SnapshotをS3に保持可能
- 別途EBS料金が必要

## EBSの特徴
①EC2にアタッチされるブロックレベルのストレージサービス

### 基本
- OSやアプリケーション、データの置き場所など様々な用途で利用される
- 実体はネットワーク接続型ストレージ
- 99.999%の可用性
- サイズは1GB~16TB
- サイズと利用期間で課金

### 特徴
- ボリュームデータはAZ内で複数のHWにデフォルトでレプリケートされており、冗長化不要
- セキュリティグループによる通信制御対象外であり、全ポートを閉じてもEBSは利用可能
- データは永続的に保存

②他のAZのインスタンスにはアタッチできない
### 特徴
- EC2のインスタンスは他のAZ内のEBSにはアクセスできない

③1つのEBSを複数のインスタンスで共有することはできない
### 特徴
- EC2インスタンスに複数のEBSを接続することはできるが、EBSを複数のインスタンスで共有することはできない
- ただし、プロビジョンドIOPSのみ複数インスタンスで共有することが可能となった

④同じAZ内のインスタンスのみ付け替えが可能
### 特徴
- 他のインスタンスに付け替えできる

## EBSのボリュームタイプ
ユースケースに応じて性能やコストが異なる5種類のボリュームタイプから選択

### SSD
#### 汎用SSD
- 仮想デスクトップ
- 低いレイテンシーを要求するアプリ
- 小〜中規模のデータベース
- 開発環境
#### プロビジョンドIOPS
- 高いI/O性能に依存するNoSQLやアプリ
- 10,000IOPSや160MB/s超のワークロード大規模DB
- Nitroシステム
- AmazonEC2インsタンス・EBS最適化インスタンスタイプで高速化
IOPS：Input/Output Per Second
つまり、1秒にどのくらい読んだり、書いたりするのか
### HDD
#### スループット最適化HDD
- ビッグデータ処理
- DWH
- 大規模なETL処理やログ分析
- ルート（ブート）ボリュームには利用不可
#### コールドHDD
- ログデータなどアクセス頻度が低いデータ
- バックアップやアーカイブ
- ルート（ブート）ボリュームには利用不可
###　マグネティック（Magnetic）
- 旧世代のボリュームで基本利用しない
- データへのアクセス頻度がくいワークロード

## スナップショットの特性
EBSはスナップショットを利用指定バックアップを取得する

## スナップショットの管理
スナップショットの作成時には静止点が推薦されているものの、いつでも実行可能でEBS操作に影響を与えない。DLMによる取得期間を設定可能。
- スナップショット作成時はデータ整合性を持つため静止点の設定を推薦
- 保存期間や世代数は無制限
- 世代管理が必要な場合はAWS CLIやAPI等で自動化する
- DLMを利用してスナップショット取得をスケジューリングできる

## スナップショットの共有
スナップショットはリージョン間を超えて利用可能
別アカウントでも可能

##　スナップショットとAMIの違い
AMIはOS設定のイメージであり、Snapshotはストレージのバックアップとなる