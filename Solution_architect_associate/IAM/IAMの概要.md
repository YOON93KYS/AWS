# IAMとは
AWS Identity and Access Management（IAM）は安全にAWS操作を実施するための認証・許可の仕組み

- AWS利用者認証の実施
- アクセスポリシーの設定
- 個人またはグループに設定

## IAMポリシー
ユーザーなどへのアクセス権限を付与するための設定ドキュメントのこと（JSON形式の文書）
- Effect："Allow"→許可、"Deny"→拒否
- Action：対象のAWSサービス ex)"s3:Get"
- Resource：対象のAWSリソース　ARNで記述
- Condition：アクセス制御が有効となる条件

* Amazon リソースネーム (ARN) ：AWS リソースを一意に識別。すべての AWS 全体でリソースを明確に指定する必要がある場合はARNが必要

## IAMユーザー
IAMポリシー内でAWSサービスを利用できるユーザー。基本操作はIAMユーザーで実施することになる

AWS上の利用者はIAMユーザーという権限を付与されたエンティティとして設定される

### ルートアカウント(IAMではない)
- AWSアカウント作成時に作られるIDアカウント
- 全てのAWSサービスとリソースを使用できる権限を有する
- 日常的なタスクはルートユーザーを使用しないことが強く推奨される

#### ルートアカウントにしかできない操作権限
- AWSルートアカウントのメールアドレスやパスワード変更
- IAMユーザーの課金情報へのアクセスに関するactivate/deactivate
- 他のAAWSアカウントへのRoute53のドメイン登録の移行
- AWSサービス（サポート等）のキャンセル
- AWSアカウントの停止
- 一括請求（コンソリデーティッドビリング、Consolidated Billing）の設定
- 脆弱性検診断フォームの提出
- 逆引きDNS申請

* 逆引き設定(rDNS reverse DNS)：
### 管理者権限（IAMユーザー）
- 管理者情報の許可が付与されたIAMユーザーのこと
- IAMの操作権限まであり
- ルートアカウントしかできない権限は付与されない
### パワーユーザー（IAMユーザー）
- パワーユーザーはIAM以外の全てのAWSサービスにフルアクセス権限を有するIAMユーザー
- IAMの操作権限なし

## IAMグループ
グループとして権限をまとめて設定された単位のこと。グループには通常は複数のIAMユーザーが設定される

## IAMロール
AWSリソースに対してアクセス権限をロールとして付与できる

## IAMの認証方式
IAMによるユーザー認証方式は利用するツールに応じて異なる
### アクセスキーID/シークレットアクセスキー
- EC2インスタンス接続などREST/Query形式
- AWS CLIやAPI利用時の認証に使用する
### X.509 Certificate
- SOAP形式のAPIリクエスト用の認証方式

* SOAP（Simple Oject Access Protocol）形式：HTTP, HTTPS, SMTPなどを通してXML基盤のメッセージをパソコンのネットワーク上でメッセージを交換するための通信プロトコル
### AWSマネジメントコンソールへのログインパスワード
- AWSアカウントごとにパスワードを設定してログイン認証する
- デフォルトは未設定（ログインできない）
### MFA(多要素認証)
- 物理デバイスなどを利用したピンコードによる認証方式
- ルートアカウントなとはMFAを付与してセキュリティを強化することが推奨される
* 昔、MFA認証をせずにロール切り替えをしようとしたら失敗した記憶がある
## ユーザーのアクティビティの記録
目的に応じてさまざまなツールを利用して記録を取得できる
### IAMアクセスアナライザー
外部エンティティと共有されているS3バケットやIAMロールなど分析し、セキュリティ上のリスクであるリソースとデータへの意図しないアクセスを特定
### Access AdvisorのService Last Accessed Data
IAMデンティティ（ユーザー、グループ、ロール）が、最後にAWSサービスにアクセスした日付と時刻を表示する機能
### Credential Report
利用日時などが記録されたIAM認証情報のレポートファイル
### AWS Config
IAMのユーザー、グループ、ロール、ポリシーの変更履歴、構成変更を管理・確認することができる機能
### AWS CloudTrail
AWSインフラストラクチャ全体でアカウントアクティビティをログに記録し、継続的に監視し、保持することができる機能